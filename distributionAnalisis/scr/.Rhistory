library(ggplot2)
library(viridis)
library(dplyr)
library(tidyverse)
library(adehabitatLT)
mycols <- c("#021128","#1b4a64", "#3585a0", "#759580", "#c78f34", "#fd9706","#fdb81c","#fbdb30")
mycols3a <-c("#021128", "#fd9706", "#3585a0")
mycols3b <-c("#1b4a64", "#fdb81c", "#759580")
WP_COSECHA_UTM_SP <- read.csv("../data/cleanData_wayPointsCoffee_UTM.csv", stringsAsFactors = FALSE )
WP_COSECHA_UTM_SP <- WP_COSECHA_UTM_SP %>%
mutate(finca = replace(finca, finca == "Irlanda", "I")) %>%
mutate(finca = replace(finca, finca == "Hamburgo", "H"))
WP_COSECHA_UTM_SP$zona[WP_COSECHA_UTM_SP$zona == "falta"] <- "zonaBaja"
WP_COSECHA_UTM_SP <- WP_COSECHA_UTM_SP %>% rowwise() %>%
group_by(ID_REC, pante)%>%  #esto debe seguirse con lo de aajo
mutate(xNorm = x_UTM - min(x_UTM)) %>%
mutate(yNorm = y_UTM - min(y_UTM))
#now the precision (not the accuracy) of the GPS goes to 5 decimal points (lat y lot) and this is equivalent to ~1m
#so we can round the xNorm and y yNorm
WP_COSECHA_UTM_SP$xNorm <- round(WP_COSECHA_UTM_SP$xNorm, 0)
WP_COSECHA_UTM_SP$yNorm <- round(WP_COSECHA_UTM_SP$yNorm, 0)
WP_COSECHA_UTM_SP$DIF_VECTOR_X <- 0
WP_COSECHA_UTM_SP$DIF_VECTOR_Y <- 0
WP_COSECHA_UTM_SP$DIF_ANGLE <-0  #este es el angulo entre vector, pero aquí necesito la resta de angulos para saber la ditribucion de angulos
WP_COSECHA_UTM_SP$DIF_ANGLE_CHANGE <-0 #este es el que voy a usar
WP_COSECHA_UTM_SP$DIF_NORM <-0  #esta es la distancia real entre puntos, nos sirve para graficar el angulo
# aqui completo los primeros
for (i in (1:dim(WP_COSECHA_UTM_SP)[1])){
if (WP_COSECHA_UTM_SP$proceso[i] != "inicio"){
WP_COSECHA_UTM_SP$DIF_VECTOR_X[i] <-  WP_COSECHA_UTM_SP$xNorm[i]-WP_COSECHA_UTM_SP$xNorm[i-1]
WP_COSECHA_UTM_SP$DIF_VECTOR_Y[i] <-  WP_COSECHA_UTM_SP$yNorm[i]-WP_COSECHA_UTM_SP$yNorm[i-1]
WP_COSECHA_UTM_SP$DIF_NORM[i] <- sqrt(WP_COSECHA_UTM_SP$DIF_VECTOR_X[i]**2+ WP_COSECHA_UTM_SP$DIF_VECTOR_Y[i]**2)
WP_COSECHA_UTM_SP$DIF_ANGLE[i] <- acos(WP_COSECHA_UTM_SP$DIF_VECTOR_X[i]/WP_COSECHA_UTM_SP$DIF_NORM[i])
}
}
for (i in (1:dim(WP_COSECHA_UTM_SP)[1])){
if (WP_COSECHA_UTM_SP$proceso[i] != "inicio"){
WP_COSECHA_UTM_SP$DIF_ANGLE_CHANGE[i] <-WP_COSECHA_UTM_SP$DIF_ANGLE[i]- WP_COSECHA_UTM_SP$DIF_ANGLE[i-1]
}
}
head(WP_COSECHA_UTM_SP)
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= as.numeric(finca)),size=1)+
geom_point(size=1)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols)+
facet_grid(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Minutes")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= as.numeric(finca)),linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols)+
facet_grid(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Minutes")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= as.numeric(finca)),linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols)+
facet_grid(finca~ID_REC)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Minutes")
ggsave("../output/mapHarvest.png", height = 8, width = 10, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca),linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols)+
facet_grid(finca~ID_REC)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Minutes")
View(WP_COSECHA_UTM_SP)
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca))+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols)+
facet_grid(finca~ID_REC)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Minutes")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" )
View(mapHarvest)
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca))+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols)+
facet_grid(finca~ID_REC)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Finca")
mapHarvest
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca))+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Finca")
ggsave("../output/mapHarvest.png", height = 8, width = 10, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Finca")
ggsave("../output/mapHarvest.png", height = 8, width = 10, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Finca")
mycols3c <-c("#759580", "#1b4a64")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Finca")
ggsave("../output/mapHarvest.png", height = 8, width = 10, device = "png")
#ggsave("../output/mapHarvest.png", height = 8, width = 18, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Finca")
ggsave("../output/mapHarvest.png", height = 6, width = 12, device = "png")
#ggsave("../output/mapHarvest.png", height = 8, width = 18, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
labs(x= "X_norm", y= "Y_norm", col= "Finca")
ggsave("../output/mapHarvest.png", height = 10, width = 12, device = "png")
#ggsave("../output/mapHarvest.png", height = 8, width = 18, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " I", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 15))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
)+
labs(x= "X", y= "Y", col= "Finca")
ggsave("../output/mapHarvest.png", height = 10, width = 12, device = "png")
#ggsave("../output/mapHarvest.png", height = 8, width = 18, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " Finca Irlanda", finca)))%>%
mutate(finca = (ifelse(finca == "H", " Finca Hamburgo", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 20))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
)+
labs(x= "X", y= "Y", col= "Finca")
ggsave("../output/mapHarvest.png", height = 10, width = 12, device = "png")
#ggsave("../output/mapHarvest.png", height = 8, width = 18, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran6" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " Finca Irlanda", finca)))%>%
mutate(finca = (ifelse(finca == "H", "Finca Hamburgo", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 20))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
)+
theme(text = element_text(size = 20))+
labs(x= "X", y= "Y", col= "Finca")
ggsave("../output/mapHarvest.png", height = 10, width = 12, device = "png")
#ggsave("../output/mapHarvest.png", height = 8, width = 18, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran11" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " Finca Irlanda", finca)))%>%
mutate(finca = (ifelse(finca == "H", "Finca Hamburgo", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 20))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
)+
theme(text = element_text(size = 20))+
labs(x= "X", y= "Y", col= "Finca")
ggsave("../output/mapHarvest.png", height = 10, width = 12, device = "png")
#ggsave("../output/mapHarvest.png", height = 8, width = 18, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran5" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " Finca Irlanda", finca)))%>%
mutate(finca = (ifelse(finca == "H", "Finca Hamburgo", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 20))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
)+
theme(text = element_text(size = 20))+
labs(x= "X", y= "Y", col= "Finca")
ggsave("../output/mapHarvest.png", height = 10, width = 12, device = "png")
#ggsave("../output/mapHarvest.png", height = 8, width = 18, device = "png")
mapHarvest<- WP_COSECHA_UTM_SP %>%
filter(ID_REC == "Ger2" | ID_REC == "Ger1" |ID_REC == "Fran5" | ID_REC == "Fran7" ) %>%
mutate(finca = (ifelse(finca == "I", " Finca Irlanda", finca)))%>%
mutate(finca = (ifelse(finca == "H", "Finca Hamburgo", finca)))%>%
rowwise() %>%
group_by(ID_REC)%>%  #esto debe seguirse con lo de aajo
mutate(deltaAc = cumsum(delta))%>%
#filter(finca == "I")%>%
unite("ID_REC_pante", ID_REC, pante, sep = "_", remove = FALSE) %>%
ggplot(aes(x= xNorm, y = yNorm)) +
geom_path(aes(col= finca), linewidth=1.5)+
geom_point(size=1.5)+ # es importante que sea path, porque así lo hace según coo estan ordenados los
scale_color_manual(values = mycols3c)+
facet_wrap(finca~ID_REC, nrow = 2)+
theme(panel.spacing = unit(0.8, "lines"), text = element_text(size = 20))+
theme_bw()+
xlim(0, 100)+
ylim(0,100)+
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
)+
theme(text = element_text(size = 20))+
theme(legend.position = "none")+
labs(x= "X", y= "Y", col= "Finca")
ggsave("../output/mapHarvest.png", height = 10, width = 10, device = "png")
#ggsave("../output/mapHarvest.png", height = 8, width = 18, device = "png")
